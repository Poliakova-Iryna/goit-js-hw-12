{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nexport function appendImagesHits(hits, wrapper) {\n    const hitsMarkup = hits.map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => `\n              <li class=\"gallery-item\">\n                  <a href=\"${largeImageURL}\" class=\"gallery-link\">\n                      <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-image\" />\n                  </a>\n                  <div class=\"info\">\n                      <p class=\"info-item\"><span>Likes</span> ${likes}</p>\n                      <p class=\"info-item\"><span>Views</span> ${views}</p>\n                      <p class=\"info-item\"><span>Comments</span> ${comments}</p>\n                      <p class=\"info-item\"><span>Downloads</span> ${downloads}</p>\n                  </div>\n              </li>`)\n              .join('');\n    wrapper.insertAdjacentHTML('beforeend',hitsMarkup);\n}\n","import iziToast from \"izitoast\";\nimport axios from \"axios\";\nimport { appendImagesHits } from \"./render-functions\";\n\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"46090964-55e0ede1337bbc868df4332a0\";\nexport const PER_PAGE = 15\n\nexport async function fetchImags(searchQuery, currentPage = 1) {\n    const options = new URLSearchParams({\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: PER_PAGE,\n        page: currentPage,\n    });\n\n    const url = `${BASE_URL}?key=${API_KEY}&${options}`;\n\n    const { data: {hits, totalHits}, request: {status} } = await axios.get(url);\n\n    if(status !== 200) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Something went wrong...',\n            position: 'topRight',\n        })\n    };\n\n    if(hits.length === 0) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Something went wrong...',\n            position: 'topRight',\n        })\n    };\n\n    return {hits, totalHits};\n}\n","import { appendImagesHits } from \"./js/render-functions\";\nimport { fetchImags, PER_PAGE } from \"./js/pixabay-api\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\n\nlet currentPage = 1;\nlet searchQuery = null;\nlet pages = 0;\n\nconst refs = {\n    form: document.querySelector('.js-form'),\n    container: document.querySelector('.js-container'),\n    searchBtn: document.querySelector('.js-search-btn'),\n    loadMoreBtn: document.querySelector('.js-load-more-btn'),\n    gallery: document.querySelector('.js-gallery'),\n}; \n\nrefs.form.addEventListener('submit', handleSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMore);\n\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n\n    searchQuery  = form.elements.query.value;\n    refs.gallery.innerHTML = '';\n    currentPage = 1;\n\n    try {\n        const { hits, totalHits } = await fetchImags(searchQuery, currentPage);\n        pages = Math.ceil(totalHits / PER_PAGE);\n        appendImagesHits(hits, refs.gallery);\n        if(totalHits > PER_PAGE) {\n            refs.loadMoreBtn.classList.remove('is-hidden');\n        }\n        lightbox = new SimpleLightbox('.js-gallery a', { \n            captionsData: 'alt', \n            captionDelay: 250 \n        });\n    }\n    catch (error) {}\n\n    finally {\n        form.reset();\n    }  \n\n}\n\n\nasync function handleLoadMore() {\n    currentPage += 1; \n    try {\n        refs.loadMoreBtn.classList.remove('is-hidden');\n\n        const { hits } = await fetchImags(searchQuery, currentPage); \n        appendImagesHits(hits, refs.gallery);\n        handleScrollView();\n\n        lightbox.refresh();\n        \n        if (currentPage >= Math.min(pages, 34)) {\n            refs.loadMoreBtn.classList.add('is-hidden');\n            iziToast.error({\n                title: 'Error',\n                message: 'We are sorry, but you have reached the end of search results.',\n                position: 'topRight',\n            })\n        }\n    } catch (error) {\n        console.error(error);\n    } finally {\n        \n    }\n}\n\nfunction handleScrollView() {\n    const lastHit = refs.container.lastElementChild;\n    const hitHeight = lastHit.getBoundingClientRect().height;\n    const scrollHeight = hitHeight * 2;\n\n    window.scrollBy({\n        top: scrollHeight,\n        left: 0,\n        behavior: 'smooth',\n    });\n}\n\n\n"],"names":["appendImagesHits","hits","wrapper","hitsMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","BASE_URL","API_KEY","PER_PAGE","fetchImags","searchQuery","currentPage","options","url","totalHits","status","axios","iziToast","pages","refs","handleSubmit","handleLoadMore","event","form","SimpleLightbox","handleScrollView","error","scrollHeight"],"mappings":"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"}