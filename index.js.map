{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nexport function appendImagesHits(hits, wrapper) {\n    const hitsMarkup = hits.map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => `\n              <li class=\"gallery-item\">\n                  <a href=\"${largeImageURL}\" class=\"gallery-link\">\n                      <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-image\" />\n                  </a>\n                  <div class=\"info\">\n                      <p class=\"info-item\"><span>Likes</span> ${likes}</p>\n                      <p class=\"info-item\"><span>Views</span> ${views}</p>\n                      <p class=\"info-item\"><span>Comments</span> ${comments}</p>\n                      <p class=\"info-item\"><span>Downloads</span> ${downloads}</p>\n                  </div>\n              </li>`)\n              .join('');\n    wrapper.insertAdjacentHTML('beforeend',hitsMarkup);\n}\n","import iziToast from \"izitoast\";\nimport axios from \"axios\";\nimport { appendImagesHits } from \"./render-functions\";\n\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"46090964-55e0ede1337bbc868df4332a0\";\nexport const PER_PAGE = 15\n\nexport async function fetchImages(searchQuery, currentPage = 1) {\n    const options = new URLSearchParams({\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: PER_PAGE,\n        page: currentPage,\n    });\n\n    const url = `${BASE_URL}?key=${API_KEY}&${options}`;\n    \n    try {\n        const { data: { hits, totalHits }, request: { status } } = await axios.get(url);\n        if(status !== 200 || hits.length === 0) {\n            refs.loadMoreBtn.classList.add('is-hidden');\n            refs.loader.style.display = 'none';\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n            });\n        }\n        return { hits, totalHits }\n    } catch (error) {\n        refs.loadMoreBtn.classList.add('is-hidden');\n        refs.loader.style.display = 'none';\n        iziToast.error({\n            title: 'Error',\n            message: 'Something went wrong',\n            position: 'topRight',\n        });\n    }\n}\n","import { appendImagesHits } from \"./js/render-functions\";\nimport { fetchImages, PER_PAGE } from \"./js/pixabay-api\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst lightbox = new SimpleLightbox('.js-gallery a', { \n    captionsData: 'alt', \n    captionDelay: 250 \n});\n\n\nlet currentPage = 1;\nlet searchQuery = null;\nlet pages = 0;\n\nconst refs = {\n    form: document.querySelector('.js-form'),\n    container: document.querySelector('.js-container'),\n    searchBtn: document.querySelector('.js-search-btn'),\n    loadMoreBtn: document.querySelector('.js-load-more-btn'),\n    gallery: document.querySelector('.js-gallery'),\n    loader: document.getElementById('loader'),\n}; \n\nrefs.form.addEventListener('submit', handleSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMore);\n\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n\n    searchQuery = form.elements.query.value.trim();\n    refs.gallery.innerHTML = '';\n    currentPage = 1;\n\n    \n    refs.loader.style.display = 'block';\n    refs.loadMoreBtn.classList.add('is-hidden');   \n\n    if (!searchQuery) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Please enter a search query.',\n            position: 'topRight',\n        });\n        refs.loader.style.display = 'none'; \n        return; \n    }\n\n    try {\n        const { hits, totalHits } = await fetchImages(searchQuery, currentPage);\n        pages = Math.ceil(totalHits / PER_PAGE);\n        appendImagesHits(hits, refs.gallery);\n        \n        if (totalHits > PER_PAGE) {\n            refs.loadMoreBtn.classList.remove('is-hidden');\n        }\n\n        if (currentPage >= Math.min(pages, 34)) {\n            refs.loadMoreBtn.classList.add('is-hidden');\n            iziToast.error({\n                title: 'Error',\n                message: 'We are sorry, but you have reached the end of search results.',\n                position: 'topRight',\n            });\n        }\n        form.reset();\n        lightbox.refresh();\n\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n            position: 'topRight',\n        });\n    } finally {\n        refs.loader.style.display = 'none';\n    }\n}\n\n\nasync function handleLoadMore() {\n    currentPage += 1; \n    refs.loader.style.display = 'block';\n    try {\n        refs.loadMoreBtn.classList.remove('is-hidden');\n\n        const { hits } = await fetchImages(searchQuery, currentPage); \n        appendImagesHits(hits, refs.gallery);\n        handleScrollView();\n\n        lightbox.refresh();\n        \n        if (currentPage >= Math.min(pages, 34)) {\n            refs.loadMoreBtn.classList.add('is-hidden');\n            iziToast.error({\n                title: 'Error',\n                message: 'We are sorry, but you have reached the end of search results.',\n                position: 'topRight',\n            })\n        }\n    } catch (error) {\n        console.error(error);\n    } finally {\n        refs.loader.style.display = 'none';\n    }\n}\n\nfunction handleScrollView() {\n    const lastHit = refs.gallery.lastElementChild;\n    const hitHeight = lastHit.getBoundingClientRect().height;\n    const scrollHeight = hitHeight * 2;\n\n    window.scrollBy({\n        top: scrollHeight,\n        left: 0,\n        behavior: 'smooth',\n    });\n}\n\n\n"],"names":["appendImagesHits","hits","wrapper","hitsMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","BASE_URL","API_KEY","PER_PAGE","fetchImages","searchQuery","currentPage","options","url","totalHits","status","axios","iziToast","lightbox","SimpleLightbox","pages","refs","handleSubmit","handleLoadMore","event","form","handleScrollView","error","scrollHeight"],"mappings":"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"}